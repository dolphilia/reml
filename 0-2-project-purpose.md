# Reml プロジェクトの目的と設計指針

この文書は、Reml の仕様を検討・決定する際の判断基準を提供します。設計で迷った時や、複数の選択肢がある時に、何を優先すべきかの指針として活用してください。

## 1. Reml が大切にする価値観

Reml の設計では、以下の価値観を重視します。優先度順に整理されており、上位の原則ほど妥協できません。

### 絶対に守るべき原則（最優先）

#### 1.1 実用に耐える性能

**何を目指すか**: 趣味や学習用途だけでなく、実際のプロダクション環境で使える性能を確保する
**具体的な基準**: 10MB以上のファイル解析でも線形時間複雑度、メモリ使用量は入力サイズの2倍以内

#### 1.2 安全性の確保

**何を目指すか**: 実行時エラーや予期しない動作を可能な限り排除する
**具体的な基準**: 型安全性の維持、メモリ安全性の保証、例外機構の不採用

### 強く推奨する原則（高優先）

#### 2.1 書きやすく覚えやすい言語

**何を目指すか**: 開発者が自然に使えて、学習コストの低い言語設計
**具体的な基準**: 基本構文要素15個以下、ネスト深度3階層まで、一貫した命名規則

#### 2.2 分かりやすいエラーメッセージ

**何を目指すか**: 問題の原因と解決方法がすぐに分かる診断情報
**具体的な基準**: エラー位置の正確な特定、期待値の明示、修正候補の提示

### 目指すべき原則（中優先）

#### 3.1 Unicode対応の充実

**何を目指すか**: 多言語・絵文字・結合文字を適切に扱える国際化対応
**具体的な基準**: byte/char/grapheme の3層モデル対応、正規化処理の標準化

#### 3.2 開発ツールとの連携

**何を目指すか**: IDE・エディタ・CI/CDツールとスムーズに連携できる環境
**具体的な基準**: LSP対応、構造化ログ出力、プラグイン機構の提供

## 2. 設計で迷った時の考え方

仕様の選択肢が複数ある場合は、以下の質問に順番に答えて判断してください。

### ステップ1: 安全性・性能への影響

- **質問**: この選択は実行時エラーや性能劣化を引き起こす可能性があるか？
- **YES の場合**: より安全で高性能な選択肢を採用
- **NO の場合**: ステップ2へ

### ステップ2: 学習・使用コストの比較

- **質問**: どちらがより直感的で、覚えやすいか？
- **判断基準**: 一般的なプログラミング経験者が30分以内に理解できるか
- **迷う場合**: より単純で一貫性のある選択肢を採用

### ステップ3: 将来性・拡張性の検討

- **質問**: 将来的な機能追加や変更に対応しやすいか？
- **判断基準**: 後方互換性の維持、段階的な導入の可能性
- **それでも迷う場合**: より保守的で実績のある選択肢を採用

### 特別な判断が必要な場合

以下の状況では、通常の優先度を変更して判断します：

- **セキュリティに関わる場合**: 安全性を最優先（性能を多少犠牲にしても）
- **標準仕様との互換性**: 既存の標準に合わせる（独自仕様は避ける）
- **エコシステムへの影響**: 他のツールやライブラリとの連携を重視

## 3. 仕様の良し悪しを測る方法

新しい仕様や変更を評価する際の基準です。

### 3.1 性能面での評価

- **測定項目**: 解析速度、メモリ使用量、スケーラビリティ
- **合格基準**: 従来手法と同等以上、ベンチマークテストでの検証
- **評価方法**: 実際のコード例での測定、ストレステストの実施

### 3.2 使いやすさの評価

- **測定項目**: 学習時間、コード記述量、エラー頻度
- **合格基準**: 初学者が1週間で基本機能を習得可能
- **評価方法**: ユーザビリティテスト、サンプルコードでの検証

### 3.3 保守性の評価

- **測定項目**: 仕様の一貫性、実装の複雑度、テストの容易さ
- **合格基準**: 仕様変更時の影響範囲が限定的
- **評価方法**: 設計レビュー、実装プロトタイプでの検証

## 4. 成功の姿

Reml プロジェクトが目指す具体的な成功像です。

### 4.1 開発者体験での成功

- **短期目標（1年以内）**: パーサーコンビネーターを使ったDSL開発が従来比50%短縮
- **中期目標（2-3年）**: Reml自身でセルフホストコンパイラが構築できる
- **長期目標（5年以内）**: 実用プロダクトでの採用事例が10件以上

### 4.2 技術面での成功

- **性能**: 10万行のコード解析が1秒以内で完了
- **安定性**: 型エラー以外の実行時エラーがゼロ
- **互換性**: 主要なUnicode仕様に完全準拠

### 4.3 エコシステムでの成功

- **ツール連携**: 主要エディタ（VS Code等）での支援機能提供
- **コミュニティ**: アクティブな開発者コミュニティの形成
- **教育**: プログラミング教育での活用事例

## 5. 想定する利用シナリオ

設計判断時に念頭に置くべき、典型的な利用場面です。

### 5.1 主要シナリオ（最重視）

- **実用ツール開発**: コンパイラ、インタープリター、コード解析ツール
- **DSL構築**: ドメイン固有言語の迅速な開発と運用
- **プロトタイピング**: 言語設計のアイデア検証と実験

### 5.2 副次シナリオ（配慮対象）

- **教育用途**: プログラミング言語論の学習教材
- **研究用途**: 新しい言語機能や最適化手法の実験
- **趣味開発**: 個人プロジェクトでの言語処理

## 6. この指針の使い方

### 6.1 日常的な仕様検討で

- 新機能追加時: 第1章の価値観に照らして必要性を判断
- 設計選択時: 第2章の判断フレームワークを適用
- 品質確認時: 第3章の評価基準でチェック

### 6.2 重要な決定で

- 大きな仕様変更: 第4章の成功像への影響を評価
- 方針転換: 第5章のシナリオへの適合性を確認
- 優先度変更: この指針自体の見直しが必要か検討

### 6.3 指針の更新

この指針も プロジェクトの成熟に合わせて更新していきます：

- **四半期ごと**: 価値観の優先度を再確認
- **年1回**: 成功指標の見直しと追加
- **重要な転換点**: 指針全体の大幅見直し

---

*この文書は Reml プロジェクトの北極星として、一貫した設計判断を支援します。迷った時は、この指針に立ち返って方向性を確認してください。*
