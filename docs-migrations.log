# docs-migrations.log

- 2025-10-06 Phase 0: docs/ 以下の骨組み、compiler/runtime/tooling/examples ディレクトリを作成し README 下書きを配置（担当: Codex）
- 2025-10-06 Phase 1: 0-*-〜5-*.md を docs/spec/ 以下へ移動し、リンクを新パスに更新（担当: Codex）
- 2025-10-06 Phase 2: guides/, notes/, plans/ を docs/ 配下へ移設し、相互リンクを再計算（担当: Codex）
- 2025-10-06 Phase 3: samples/ 配下のサンプルを examples/ に移設し、リンクを更新（担当: Codex）
- 2025-10-06 Phase 4: ルート README を再構成し、docs/README.md との役割分担を明確化（担当: Codex）
- 2025-10-06 Phase 5: compiler/runtime/tooling の README と骨組みを追加し、実装タスクの TODO を明記（担当: Codex）
- 2025-10-06 Docs Index: docs/README.md と各サブディレクトリ README を目次化（担当: Codex）
- 2025-11-06 Rust Migration: `compiler/rust/` と `docs/plans/rust-migration/` を追加し、移植計画ドキュメントの集約先を作成（担当: Codex）
- 2025-11-06 Docs (Porting): 一般原則ドキュメント `docs/plans/rust-migration/language-porting-principles.md` を追加（担当: Codex）
- 2025-11-06 Docs (Porting): OCaml→Rust 移植指針 `docs/plans/rust-migration/ocaml-to-rust-porting-principles.md` を追加（担当: Codex）
- 2025-11-06 Docs (Porting): プロジェクト固有原則 `docs/plans/rust-migration/project-porting-principles.md` を追加（担当: Codex）
- 2025-11-06 Docs (Porting): 統合原則 `docs/plans/rust-migration/unified-porting-principles.md` を追加（担当: Codex）
- 2025-11-06 Docs Cleanup: 旧原則ドキュメント（`language-porting-principles.md`, `ocaml-to-rust-porting-principles.md`, `project-porting-principles.md`）を統合版へ集約し削除（担当: Codex）
- 2025-12-16 Core Prelude F1-3: `docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md` の F1-3 行を完了扱いに更新し、`Iter::empty`/`Iter::once`/`Iter::repeat`/`Iter::range` の証跡を `docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml`（`meta.last_updated = "2025-12-16 / WBS 3.1c-F1-3"`）、`reports/spec-audit/ch1/iter.json`（range/repeat/once/empty KPI）、`reports/spec-audit/ch0/links.md#iter-generators`、`docs/notes/core-library-outline.md#iter-f1-生成-api-監査ログ` に横断的に記録した（担当: Codex）
- 2025-12-20 Core Prelude F1-5: `cargo xtask prelude-audit --section iter --baseline docs/spec/3-1-core-prelude-iteration.md --wbs 3.1c-F1-5` を実行し、生成 API 15 件を `reports/spec-audit/ch1/iter.json` の `iterator.api.coverage=1.0`・`iter.generators.entries=15` として記録。`reports/spec-audit/ch0/links.md#iter-generators` にコマンドログを追記し、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml`（`meta.last_updated = "2025-12-22 / WBS 3.1c-F1-4/5"`）、`docs/notes/core-library-outline.md#iter-f1-生成-api-監査ログ`、`docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md`、`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md` を同期させた（担当: Codex）
- 2025-12-22 Core Prelude F1-4: `Iter::unfold`/`Iter::try_unfold` の実装を `compiler/rust/runtime/src/prelude/iter/generators.rs` に追加し、`collect-iterator-audit --section iter --case unfold|try_unfold` と `scripts/validate-diagnostic-json.sh --pattern iterator --module try_unfold` の結果を `reports/spec-audit/ch1/iter.json`／`reports/spec-audit/ch0/links.md#iter-f1-4` に保存。`prelude_api_inventory.toml`（`Iter::unfold`/`Iter::try_unfold` = `rust_status=implemented`）、`docs/notes/core-library-outline.md#iter-generators-f1-4-設計メモwbs-31c-f1-4`、`docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md` を更新し、`pending_entries` を解消した（担当: Codex）
- 2025-12-24 Core Prelude F2: `compiler/rust/runtime/src/prelude/iter/adapters.rs` を追加して `Iter::map`/`filter`/`filter_map`/`flat_map`/`scan`/`take`/`drop`/`enumerate`/`zip`/`buffered` を実装し、`EffectSet::with_mem_bytes`・`IterStep::Error(IterError::Buffer)`・`BufferStrategy` を導入。`compiler/rust/frontend/tests/core_iter_adapters.rs` を作成し `cargo test --manifest-path compiler/rust/frontend/Cargo.toml iter_buffered_sets_mem_effects` を実行、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` にアダプタ系 API の `rust_status=implemented` 記録と KPI 参照を追記した（担当: Codex）
- 2026-02-05 Iter/Collector Remediation Step3: 存在しない `core_iter_pipeline__*.snap` への参照を `docs/notes/core-library-outline.md`・`docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md`・`reports/spec-audit/ch0/links.md` から削除し、TODO で復活条件を明記。`reports/spec-audit/ch1/iter.json` を `status=pending` に更新し、`docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md` §3 へ状況メモを追加した（担当: Codex）
- 2026-02-10 Core Prelude KPI 再集約: `core_iter_pipeline`/`core_iter_effects` スナップショットを復旧し、`reports/spec-audit/ch0/links.md#iterator-f3`・`#collector-f3-監査ログ` に `cargo +nightly test`・`collect-iterator-audit-metrics --require-success`・`scripts/validate-diagnostic-json.sh` のコマンドログを追記。`reports/spec-audit/ch1/iter.json`/`reports/iterator-stage-summary.md`/`reports/iterator-collector-summary.md` を最新 KPI (`iterator.api.coverage=1.0`, `iterator.stage.audit_pass_rate=1.0`, `collector.stage.audit_pass_rate=1.0`, `collector.effect.mem=2/7`) へ更新し、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` の `last_updated` 文字列と `docs/notes/core-library-outline.md` の監査ログ節を同期した（担当: Codex）
- 2027-01-26 Core Prelude Iterator KPI: `EffectLabels::predicate_calls` と `Iter::fold/reduce/all/any/find/try_fold` を Rust 実装へ追加し、`core_iter_pipeline`/`core_iter_effects`/`core_iter_collectors` の snapshot・`core_iter_terminators.rs` を更新。`reports/spec-audit/ch1/iter.json`・`reports/iterator-stage-summary.md`・`reports/iterator-stage-metrics.json`・`reports/spec-audit/ch0/links.md#iterator-f3` を再収集し、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` (`try_fold`/`try_collect`) の `rust_status` を `implemented` へ更新した（担当: Codex）
- 2027-01-05 Rust Migration P1 W3: 型推論スタック棚卸しメモ `docs/plans/rust-migration/appendix/type-inference-ocaml-inventory.md` を追加し、`1-0-front-end-transition.md`／`p1-front-end-checklists.csv`／`docs/plans/bootstrap-roadmap/{2-5,2-7}` とリンクさせる更新を実施（担当: Codex）
- 2027-01-17 Rust Migration P1 W3 Step5: `p1-front-end-checklists.csv`・`1-1-ast-and-ir-alignment.md`・`1-2-diagnostic-compatibility.md`・`1-0-front-end-transition.md` を更新し、`reports/dual-write/front-end/w3-type-inference/2027-01-15-w3-typeck/` の進捗反映と `README`/`docs/spec/{1-2,3-6}` 向けフォローアップを記録（担当: Codex）
- 2027-01-18 Rust Migration P1 W3 Step5 追補: `README.md`・`docs/plans/rust-migration/README.md`・`docs/spec/1-2-types-Inference.md`・`docs/spec/3-6-core-diagnostics-audit.md` を更新し、`--dualwrite-root`/`--emit typeck-debug` の導線、`TypecheckConfig` 設定、`effects-metrics.{ocaml,rust}.json` の監査要件を仕様へ取り込んだ（担当: Codex）
- 2025-11-14 Rust Migration P1 TPM-LEX-01: `compiler/rust/frontend/tests/lexer/core_parse.rs` と `compiler/ocaml/tests/golden/core_parse_lex_tests.tokens.json` を追加し、`poc_frontend` に `--emit-tokens` 出力を与えて `reports/dual-write/front-end/w1-lexer/` を整備することで `core_parse_lex_tests.ml` 相当分のトークン差分監査を Rust 側に移植した（担当: Codex）
- 2025-11-14 Rust Migration P1 TPM-LEX-01 (metrics): `scripts/poc_dualwrite_compare.sh` に `--mode lexer` と `docs/plans/bootstrap-roadmap/p1-test-migration-lexer-cases.txt` を追加し、OCaml/ Rust のトークン JSON を `reports/dual-write/front-end/w1-lexer/<run>` へ記録するとともに `collect-iterator-audit-metrics.py --section lexer --case core_parse_lex_tests` で `lexer.identifier_profile_*` の±0.5 ルールを追跡するパイプラインを立ち上げた（担当: Codex）。
- 2025-11-15 Rust Migration P1 TPM-TYPE-01: `compiler/rust/frontend/tests/typeck_inference_report.rs` を追加し、`TypecheckReport` の Typed AST/constraints/metrics が `serde_json::to_value` で直列化可能であることを確認するテストを実装した上で `cargo test --test typeck_inference_report` を通し、`reports/dual-write/front-end/w3-type-inference` 向け JSON スキーマを意識した移植モニタリングを整備（担当: Codex）
- 2025-11-19 Rust Migration P2-8 SYNTAX-002: `compiler/rust/frontend/src/parser/module_parser.rs` を `ModuleStage` 単位で再実装し、`TraceEvent::ModuleStageEntered` / `ModuleDeclAccepted` を導入。`compiler/rust/frontend/tests/parser.rs` に `parser::module` 統合テスト（`use_nested` / `block_scope` / `effect_handler`）を追加し、`reports/spec-audit/ch1/module_parser-20251119-{parser-tests,dualwrite}.md` を作成。関連計画（`docs/plans/bootstrap-roadmap/2-8-spec-integrity-audit.md`, `docs/plans/rust-migration/3-0-ci-and-dual-write-strategy.md`）と `docs/notes/spec-integrity-audit-checklist.md` の `SYNTAX-002/module_parser` 行を更新（担当: Codex）
- 2025-11-21 Rust Migration P2-8 Streaming: `compiler/rust/frontend/tests/streaming_metrics.rs` に `SampleCase` と `module_header_acceptance`／`effect_handler_acceptance`／`bridge_signal_roundtrip` を追加し、`cargo test --manifest-path compiler/rust/frontend/Cargo.toml streaming_metrics -- --nocapture` のログを `reports/spec-audit/ch1/streaming_metrics-20251121-log.md` に保存。`reports/spec-audit/ch1/streaming_use_nested-20251121-diagnostics.json` / `streaming_effect_handler-20251121-diagnostics.json` を作成し、`docs/spec/1-1-syntax.md`・`docs/spec/0-3-code-style-guide.md`・`docs/spec/1-1-syntax/examples/README.md`・`docs/plans/rust-migration/{overview,3-0-ci-and-dual-write-strategy.md}`・`docs/plans/bootstrap-roadmap/2-8-spec-integrity-audit.md`・`docs/notes/spec-integrity-audit-checklist.md`・`reports/spec-audit/diffs/SYNTAX-002-ch1-rust-gap.md` を Streaming ベースラインに合わせて更新（担当: Codex）
- 2025-11-20 Rust Migration P2-8 SYNTAX-002 追補: `reports/spec-audit/ch1/use_nested-20251119-{diagnostics.json,trace.md}`, `block_scope-20251119-*`, `effect_handler-20251119-*` を追加し、`ModuleStage` トレース (`trace_id = syntax:module-stage::<stage>`) と dual-write ログ (`module_parser-20251119-dualwrite.md`) を Phase 3 CI ブロッカーで参照できるよう整理。`docs/plans/bootstrap-roadmap/2-8-spec-integrity-audit.md`, `docs/plans/rust-migration/{1-0,3-0}`、`docs/notes/spec-integrity-audit-checklist.md` を更新して `SYNTAX-002/module_parser` を `Closed (P2-8 W38)` に移行（担当: Codex）
- 2025-11-28 Rust Migration P1 TPM-LEX-02: 識別子テストを `compiler/rust/frontend/tests/lexer/identifier.rs` で追加し、ASCII 拒否メッセージの詳細化、Unicode 正規化・ゼロ幅結合子対応、`unicode-normalization` の導入を実施、`compiler/ocaml/tests/golden/identifier_lex_tests.tokens.json` を生成して `docs/plans/bootstrap-roadmap/p1-test-migration-lexer-cases.txt` へ `TPM-LEX-02` エントリを追加することで `reports/dual-write/front-end/w1-lexer/identifier` 用の Dual-write モニタリングを整備した（担当: Codex）。
- 2025-11-30 Rust Migration P1 TPM-LEX-03: `scripts/poc_dualwrite_compare.sh --mode ast --cases docs/plans/bootstrap-roadmap/p1-test-migration-parser-cases.txt` を `DUALWRITE_RUN_ID=2025-11-30-tpm-lex-03` で実行したうえで `reports/dual-write/front-end/w2-ast-alignment/tpm-lex-03/dualwrite.bundle.json` を生成し、`collect-iterator-audit-metrics.py --section parser --source reports/dual-write/front-end/w2-ast-alignment/tpm-lex-03/dualwrite.bundle.json --case TPM-LEX-03` で Packrat 統計と `diagnostics.expected` の差分メトリクスを `reports/dual-write/front-end/w2-ast-alignment/metrics/parser-tpm-lex-03.json` に記録（担当: Codex）。
- 2025-12-05 Rust Migration P1 TPM-LEX-04: `compiler/rust/frontend/src/parser/mod.rs` に `expectation_tests`/`parse_result_tests` を追加し、`ExpectedTokenCollector` の空集合補正・`ParserDriver::parse` の `legacy_error.expected`/`diagnostics.expected_summary`/`farthest_error_offset` を検証するユニットテスト群を実装した（担当: Codex）。
- 2025-11-15 Rust Migration P1 TPM-TYPE-03: `docs/plans/bootstrap-roadmap/p1-test-migration-ffi-cases.txt` と `scripts/poc_dualwrite_compare.sh` の `case_origin`/`case_metrics` パスを整備し、`collect-iterator-audit-metrics.py --section diag --metrics-case effects-contract` を呼ぶことで `effects.contract.stage_mismatch`/`capability_missing`/`ownership` の差分監査と `reports/dual-write/front-end/w4-diagnostics/effects-contract` 出力を双方向追跡できるようにした（担当: Codex）。
- 2025-11-15 Rust Migration P1 TPM-DIAG-01: `docs/plans/bootstrap-roadmap/p1-test-migration-diagnostic-cases.txt` を追加し `scripts/poc_dualwrite_compare.sh --mode diag --cases ...` ならびに `collect-iterator-audit-metrics.py --section diag --metrics-case cli_diagnostics` を組み合わせて `diagnostics.expected_summary_presence`/`diagnostics.count`/`effects.contract.stage_mismatch`/`effects.contract.capability_missing`/`effects.contract.ownership` の監査パイプラインを確立。`docs/plans/bootstrap-roadmap/2-5-spec-drift-remediation.md`/`2-7-deferred-remediation.md` の診断監査欄と `docs/plans/rust-migration/1-2-diagnostic-compatibility.md` の検証ステップに追記し、`p1-front-end-checklists.csv` に CLI diag KPI を登録した（担当: Codex）。
- 2025-12-08 Phase3 WBS 3.1c F1: `compiler/rust/runtime/src/prelude/iter/generators.rs` を新設し `Iter` の `from_state`/`stage_snapshot`/`effect_labels` を移管、`IterStepMetadata` と `attach_effects` を導入して効果ラベルの注入点を整理。`docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md`・`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml`（`module = "Iter"` 脚注付与）にも進捗を記録（担当: Codex）。
- 2025-11-20 Phase3 WBS 3.1c Step4: `compiler/rust/frontend/tests/core_iter_pipeline.rs`/`core_iter_effects.rs` を追加し、`tests/snapshots/core_iter_pipeline__core_iter_pipeline.snap`/`core_iter_effects__*.snap` を生成。`reports/spec-audit/ch1/iter.json`、`reports/iterator-stage-summary.md`、`reports/iterator-stage-metrics.json` を更新し、`.github/workflows/bootstrap-linux.yml#rust-prelude-tests` を新設。`docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md`、`docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md`、`docs/notes/core-library-outline.md`、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` の Iter セクションを改訂（担当: Codex）。
- 2026-02-18 Core Prelude WBS 3.1c-G1: `reports/spec-audit/ch1/iterator.map-filter.diagnostics.json` を追加し、`tmp/iter_metrics` で `Iter::map` / `Iter::filter` の Stage/Efffect/latency を実測。`python3 tooling/ci/collect-iterator-audit-metrics.py --source reports/spec-audit/ch1/iterator.map-filter.diagnostics.json --section iterator --case map --case filter --output reports/iterator-map-filter-metrics.json --require-success` を実行して `iterator.stage.audit_pass_rate=1.0` を記録し、`reports/iterator-map-filter-metrics.json` に `adapter_metrics`（latency/predicate_calls）を追記。`scripts/validate-diagnostic-json.sh --pattern iterator.map --pattern iterator.filter` の結果とコマンド履歴を `reports/spec-audit/ch0/links.md#iter-g1-map-filter` へ追加した（担当: Codex）。
- 2026-02-18 Core Prelude WBS 3.1c-G1: `docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md` の §3/§4 に Iter コア構造と G1 map/filter 立ち上げタスクリストを追記し、`docs/plans/bootstrap-roadmap/3-1-iter-collector-remediation.md` §5 と `docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md` §3.0.3a に同内容の連携メモを反映。`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md` へ `iterator.map.latency`/`iterator.filter.predicate_count` KPI を追加し、`docs/notes/core-library-outline.md#iter-g1-map-filter`・`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml`（`Iter.map`/`Iter.filter` = `rust_status=working` + KPI/テスト名記録）・`reports/spec-audit/ch0/links.md#iter-g1-map-filter` の証跡を同期した（担当: Codex）。
- 2027-03-06 Core Prelude H1: `docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md` §4.b H1 に `collect_with` / `CollectOutcome::audit` 実装ログと `core_iter_terminators.rs` テスト、`collect-iterator-audit-metrics.py --section iterator --case terminators` コマンド列を追記し、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml`（collect_list/collect_vec/collect_string / `meta.last_updated = "2027-03-06 / WBS 3.1c-H1"`）、`docs/notes/core-library-outline.md#collector-f2-監査ログ`、`docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md#collector-f2-監査ログ`、`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md`（`iterator.collect.bridge_parity` KPI + 実測値）、`reports/spec-audit/ch0/links.md#iter-terminators-h1`、`reports/iterator-collector-summary.md#collect_vec_reserve-h1` を同期した（担当: Codex）。
- 2029-04-27 Rust Migration P1 W4: `docs/plans/rust-migration/appendix/w4-diagnostic-cases-recover-stream.txt` で Recover/Streaming ケースを再実行し、`reports/dual-write/front-end/w4-diagnostics/20290427-w4-diag-recover-stream/*/effects-metrics.rust.err.log` が `bridge_stage.audit_presence < 1.0` を記録して `metrics_ok=false` のままになったため、Stage/Capability 拡張を補うべく `TODO: DIAG-RUST-06` を追跡（担当: Codex）。
- 2029-04-28 Rust Migration P1 W4: `docs/plans/rust-migration/appendix/w4-diagnostic-cases-type-effect.txt` を使って `scripts/poc_dualwrite_compare.sh --mode diag --force-type-effect-flags` を再実行。`ffi_stage_messagebox` / `ffi_ownership_mismatch` の `parser-metrics.rust.err.log` に `parser.expected_summary_presence < 1.0`、`ffi_async_dispatch` では OCaml diagnostics が未出力と判明したため、`parser.expected_summary_presence` と `expected_tokens` を gate に組み込む運用を継続（担当: Codex）。
- 2029-04-29 Rust Migration P1 W4: `docs/plans/rust-migration/appendix/w4-diagnostic-cases-cli-lsp.txt` で CLI/LSP ケースを再測定し、`reports/dual-write/front-end/w4-diagnostics/20290429-w4-diag-cli-lsp/*/effects-metrics.rust.err.log` の `bridge_stage.audit_presence < 1.0` を確認。`npm run ci --prefix tooling/lsp/tests/client_compat -- diag-w4 20290429-w4-diag-cli-lsp` と `tooling/lsp/tests/client_compat/scripts/report-fixture-diff.mjs` で diff を生成したうえで、`p1-front-end-checklists.csv` の CLI/LSP 行と `docs/plans/rust-migration/1-2-diagnostic-compatibility.md#1-2-17-cli-lsp-runconfig-整合diag-rust-07` に Run ID を追加して `TODO: DIAG-RUST-07` を継続（担当: Codex）。
- 2029-05-15 Rust Migration P1 W4.5: `1-0-front-end-transition.md`・`1-1-ast-and-ir-alignment.md`・`1-2-diagnostic-compatibility.md`・`1-3-dual-write-runbook.md`・`p1-front-end-checklists.csv`・`appendix/w4-diagnostic-case-matrix.md`・`w4-diagnostic-cases.txt` を更新し、W4.5 クロージングレビュー結果と `reports/dual-write/front-end/P1_W4.5_frontend_handover/` の構成を記録。`2-0`/`2-1`/`2-2` 計画書と `overview.md`・`README.md` に受け渡し表を追加し、Streaming/Type&Effect/CLI を `Pending(W4.5)` として Phase P2 の TODO に移送（担当: Codex）。
- 2025-11-15 Rust Migration P2: Phase P2 統合計画 `docs/plans/bootstrap-roadmap/2-9-rust-migration-p2-plan.md` を `docs/plans/rust-migration/2-3-p2-backend-integration-roadmap.md` へ移動し、番号・README/overview 参照・Go/No-Go 記述を Rust 移植ディレクトリ側で維持できるよう更新（担当: Codex）。
- 2025-11-15 Rust Migration P2 W4: `docs/plans/rust-migration/2-0-llvm-backend-plan.md` に Windows/macOS 向け W4 セクションを追記し、`docs/plans/bootstrap-roadmap/2-5-spec-drift-remediation.md`/`2-7-deferred-remediation.md`/`docs/plans/rust-migration/0-2-windows-toolchain-audit.md` への参照連携と P3 CI への `opt -verify` 自動化の橋渡し準備を記録（担当: Codex）
- 2029-05-20 Rust Migration P2G-04: `compiler/rust/adapter/reml_adapter` クレートで `EnvError`/`EnvMutation` を抽象化し、`compiler/rust/runtime/ffi/src/env.rs` から `AuditContext` に `env_mutation` を記録するブリッジを追加したことで `docs/spec/3-10-core-env.md` の監査要件を Rust 側で再現するとともに `docs/plans/rust-migration/p2-spec-compliance-gap.md#5` に計画を追記（担当: Codex）
- 2029-05-25 Rust Migration P2G-04: `compiler/rust/adapter` に `AdapterCapability` と各サブシステムモジュールを追加し、`adapter.*` 監査メタデータを出力する `fs`/`network`/`time`/`random`/`process` の土台と P2G-04.03 の計画追記を整備（`cargo test --manifest-path compiler/rust/adapter/Cargo.toml` 実行済）（担当: Codex）
- 2025-11-18 Rust Migration P1 W2 ExprParser/EFFECT: `docs/plans/rust-migration/{1-0-front-end-transition.md,1-2-diagnostic-compatibility.md,overview.md}`・`docs/plans/bootstrap-roadmap/2-8-spec-integrity-audit.md`・`docs/notes/spec-integrity-audit-checklist.md` を更新し、`reports/spec-audit/ch1/block_scope-20251118-*.{json,trace.md}` / `effect_handler-20251118-*.{json,trace.md,dualwrite.md}` / `reports/spec-audit/diffs/SYNTAX-003-ch1-rust-gap.md` を追加して `rust-gap SYNTAX-003` をクローズ。`docs/plans/rust-migration/unified-porting-principles.md` へ `syntax:expr-*` 観測点の統合方針を追記した（担当: Codex）。
- 2025-11-22 Rust Migration P2-8 Step7: `poc_frontend` を `reml_frontend` へ昇格し、`TypecheckDriver::infer_module` の fallback を削除して `typeck.aborted.ast_unavailable` 診断を追加。`scripts/poc_dualwrite_compare.sh`・`tooling/lsp/tests/client_compat/fixtures/*.json` を新 CLI に合わせ、`typeck/typeck-debug.rust.json` に `schema_version = "3.0.0-alpha"`・`stage_trace`・`used_impls` を保存するルートを確立。`docs/spec/{0-3,1-1,3-6}`、`docs/plans/{rust-migration/overview,bootstrap-roadmap/2-8,bootstrap-roadmap/3-0-phase3-self-host}`、`docs/notes/spec-integrity-audit-checklist.md` を更新し、`reports/spec-audit/ch1/typeck-fallback-removal-20251122.md` に記録（担当: Codex）
- 2027-02-15 Bootstrap Roadmap WBS 2.1a: `compiler/rust/runtime/ffi` に `core_prelude` モジュール（Option/Result/Never/Try の骨格）と Cargo feature `core_prelude` を追加し、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` を新設して Option/Result API の在庫表を機械可読に整理、`cargo check --features core_prelude` で導入検証（担当: Codex）。
- 2025-11-18 Phase3 Prelude WBS 2.1b: `compiler/rust/runtime/ffi/src/core_prelude/{option.rs,result.rs}` に `#[must_use]`/`effect {debug}` 対応の API を実装し、`compiler/rust/frontend/tests/core_prelude_option_result.{rs,snap}` で 16 シナリオ snapshot を追加。`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` に `wbs` フィールド付きで `rust_status=implemented` を記録し、`.cargo/config.toml` + `compiler/rust/xtask/` 由来の `cargo xtask prelude-audit --wbs 2.1b --strict` 出力を `reports/spec-audit/ch0/links.md` に保存した（担当: Codex）
- 2025-11-18 Phase3 Prelude WBS 3.1a F3: `docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md` に Snapshot/KPI サブセクションと F3 進行メモを追加し、`reports/spec-audit/ch0/links.md`・`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md`・`docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md`・`docs/notes/core-library-outline.md` に Iter F3 参照リンクと KPI 更新手順を追記。`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` へ `module="Iter"`/`"Collector"` のエントリを追加して `last_updated` を WBS 3.1a F3 日付へ更新した（担当: Codex）
- 2025-11-20 Iter/Collector Remediation Step3: `cargo xtask prelude-audit` に `--section/--module` を実装（`compiler/rust/xtask/src/main.rs`）し、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` の Iter/Collector 項目を実際のテスト根拠へ書き換えた。`cargo xtask prelude-audit --section iter --strict --baseline docs/spec/3-1-core-prelude-iteration.md` の実行結果を `reports/spec-audit/ch1/iter.json` と `reports/spec-audit/ch0/links.md#iter-collector-remediation` に記録し、`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md` の KPI を最新値（missing_api=2, iterator.api.coverage=0.9473）へ更新した。（担当: Codex）
- 2026-02-18 Core Prelude Adapter G1: `compiler/rust/runtime/src/prelude/iter/adapters.rs` を `adapters/{mod,map,filter}.rs` へ再編し、`IterDriver::stepper` が `EffectSet` を受け取るように変更。`EffectLabels::predicate_calls` を動的に積算し、`tests/snapshots/core_iter_adapters__core_iter_adapters.snap` と `core_iter_pipeline__core_iter_pipeline.snap` を更新した。`docs/plans/bootstrap-roadmap/{3-1-core-prelude-iteration-plan.md,3-0-phase3-self-host.md,3-1-iter-collector-remediation.md}`・`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml`・`docs/notes/core-library-outline.md#iter-g1-map-filter`・`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md`・`reports/spec-audit/ch0/links.md#iter-g1-map-filter`・`reports/iterator-map-filter-metrics.json` を同期し、`iterator.filter.predicate_count = 4` / Stage=`Exact("stable")` を KPI に登録した（担当: Codex）
- 2026-02-21 Core Prelude G2: `Iter.flat_map`/`Iter.zip` の Stage/KPI を `cargo test core_iter_adapters -- --include-ignored flat_map_vec zip_mismatch` と `python3 tooling/ci/collect-iterator-audit-metrics.py --section iterator --case flat_map --case zip --output reports/iterator-flatmap-metrics.json --secondary-output reports/iterator-zip-metrics.json --require-success` で採取し、`reports/spec-audit/ch0/links.md#iter-adapters`・`docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md`・`docs/plans/bootstrap-roadmap/3-1-iter-collector-remediation.md`・`docs/notes/core-library-outline.md#iter-g2-flat-zip`・`docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md#iter-adapter`・`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md`・`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml` に Run-ID と KPI 値を反映。`reports/iterator-stage-summary.md`・`reports/diagnostic-format-regression.md#iterator.zip_mismatch` にもリンクし、逸脱テンプレートを `docs/plans/bootstrap-roadmap/2-7-deferred-remediation.md#iterator-adapter-esc` に追加した（担当: Codex）
- 2027-02-22 Core Prelude G3 buffered/backpressure: `core_iter_adapters.rs::buffered_window` / `collect-iterator-audit-metrics.py --section iterator --case buffered` / `cargo bench -p compiler-rust-frontend iter_buffered` を実行し、`reports/iterator-buffered-metrics.json`・`reports/benchmarks/iter_buffered-2027-02-22.json`・`reports/spec-audit/ch0/links.md#iter-buffered`・`reports/spec-audit/ch1/core_iter_adapters.json`・`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml`・`docs/notes/core-library-outline.md#iter-g3-buffered-backpressure`・`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md` を Run-ID `2027-02-22-iter-adapter-g3` で同期した（担当: Codex）
- 2027-02-24 Core Prelude WBS 3.1c-G4: `cargo xtask prelude-audit --section iter --filter adapter --strict --output reports/spec-audit/ch1/core_iter_adapters.json`, `python3 tooling/ci/collect-iterator-audit-metrics.py --section iterator --case adapters --source reports/spec-audit/ch1/core_iter_adapters.json --output reports/iterator-adapter-metrics.json --require-success`, `scripts/validate-diagnostic-json.sh --pattern iterator.map --pattern iterator.zip reports/spec-audit/ch1/core_iter_adapters.json` を同一ブランチで実施。`iterator.adapter.coverage = 1.0`／`diagnostic.audit_presence_rate = 1.0`／`iterator.stage.audit_pass_rate = 1.0` を `reports/spec-audit/ch1/core_iter_adapters.json`・`reports/iterator-adapter-metrics.json` に保存し、`docs/plans/bootstrap-roadmap/3-1-core-prelude-iteration-plan.md` §4.a、`docs/plans/bootstrap-roadmap/3-0-phase3-self-host.md#iter-adapter`、`docs/plans/bootstrap-roadmap/3-1-iter-collector-remediation.md`、`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md`、`docs/plans/bootstrap-roadmap/assets/prelude_api_inventory.toml`、`reports/spec-audit/ch0/links.md#iter-adapters-g4`、`docs/notes/core-library-outline.md#iter-adapter` を Run-ID `2027-02-24-iter-adapter-g4` で更新した（担当: Codex）
- 2027-03-19 Core Prelude Remediation Plan: `docs/plans/bootstrap-roadmap/3-1-core-prelude-remediation.md` を新設し、`Iter::drain_into_collector` のエラー伝播、`prelude_api_inventory` の陳腐化、`Iter::empty/once` テスト不足に対する対応手順を定義。あわせて `docs/plans/bootstrap-roadmap/README.md` に索引用リンクを追加し、新計画の扱いを Phase 3 M1 補完タスクへ反映した（担当: Codex）
- 2027-03-24 Core Collections Persistent Metrics: `compiler/rust/runtime/src/collections/persistent/{list,btree}.rs` に構造共有メトリクス API を追加し、`compiler/rust/runtime/ffi/src/core_collections_metrics.rs`/`benches/core_collections_persistent.rs`/`examples/core_collections_metrics.rs` で List 10^5・Map 5×10^4 ベンチを実装。`cargo run --manifest-path compiler/rust/runtime/ffi/Cargo.toml --features core_prelude --example core_collections_metrics -- docs/plans/bootstrap-roadmap/assets/metrics/core_collections_persistent.csv` を記録し、`docs/plans/bootstrap-roadmap/{0-3,3-0,3-2}` と `reports/spec-audit/README.md` へリンクした（担当: Codex）
- 2027-03-29 Core Collections Mutable WBS3.2: `docs/plans/bootstrap-roadmap/3-2-core-collections-plan.md` に Vec/Cell/Ref/Table の実施ログと `--suite collectors` CI 手順を追記し、`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md`・`reports/iterator-collector-summary.md`・`docs/plans/bootstrap-roadmap/3-6-core-diagnostics-audit-plan.md` を新 KPI (`vec_mut_ops_per_sec`, `cell_mutations_total`, `ref_borrow_conflict_rate`, `table_insert_throughput`, `csv_load_latency`) と `collector.effect.cell`/`collector.effect.rc` ハーネスに合わせて更新（担当: Codex`)
- 2027-04-03 Core Collections Mutable effect trace: `docs/plans/bootstrap-roadmap/3-2-core-collections-plan.md` の `3.2` セクションに `Cell`/`Ref` の effect トレースと FFI ハンドル設計を具体化し、`docs/plans/bootstrap-roadmap/3-6-core-diagnostics-audit-plan.md` の `Core Collections effect 連携` に `collector.effect.cell`/`collector.effect.rc` の監査ルートを追記。`docs-migrations.log` 自身にも `Cell/Ref effect trace` 記録を明記し、KPI 周りの説明を `reports/iterator-collector-summary.md` へ参照リンクする（担当: Codex）
- 2027-05-30 Core Collections Ref capability: `compiler/rust/runtime/ffi/src/handles/ref_handle.rs`/`handles/mod.rs` に `RefHandle` と `register_ref_capability()` を実装し、`compiler/rust/runtime/ffi/src/lib.rs` から再公開。`compiler/rust/runtime/ffi/src/capability_handle.rs` に `RefCapability` variant を加えて `core.collections.ref` を `CapabilityRegistry` へ登録し、`docs/guides/runtime/runtime-bridges.md`／`docs/plans/bootstrap-roadmap/3-8-core-runtime-capability-plan.md`／`docs/plans/bootstrap-roadmap/3-2-core-collections-plan.md` に契約・履歴を追記して監査チームと共有（担当: Codex）
- 2027-06-01 Core Collections Cell/Ref effect trace: `reports/iterator-collector-summary.md#collect_cell_ref_effects`/`docs/plans/bootstrap-roadmap/0-3-audit-and-metrics.md`/`docs/plans/bootstrap-roadmap/assets/metrics/core_collections_persistent.csv` の KPI を強化し、`scripts/validate-diagnostic-json.sh --suite collectors --pattern collector.effect.cell --pattern collector.effect.rc` と `tooling/ci/collect-iterator-audit-metrics.py --suite collectors --scenario ref_internal_mutation --require-success --require-cell` を gate にして `collector.effect.cell`/`collector.effect.rc` を CI で追跡する運用を確立した（担当: Codex）
- 2025-12-03 Core Collections Cell/Ref gate: `python3 tooling/ci/collect-iterator-audit-metrics.py --suite collectors --scenario ref_internal_mutation --require-success --require-cell --output reports/audit/dashboard/collectors-20251203.json` と `scripts/validate-diagnostic-json.sh --suite collectors` を実行し、`collector.effect.cell_rc`/`collector.table.csv_import` の `metric_missing` と `diagnostic.audit_presence_rate = 0.0`、`core_iter_collectors.json` の `primary`/`audit_metadata`/`timestamp` 欠落を `reports/audit/dashboard/collectors-20251203.{json,md}` に記録。`docs/plans/bootstrap-roadmap/3-2-core-collections-plan.md#325-監査-ci-gate-実行ログrun-id-20251203-collectors-gate` と `docs/plans/bootstrap-roadmap/3-6-core-diagnostics-audit-plan.md#8.3-実施結果run-id-20251203-collectors-gate` を更新し、Cell/Ref effect trace の CI gate 失敗状態とフォローアップを共有（担当: Codex）
- 2027-03-30 Core Text Samples: `examples/core-text/text_unicode.reml` と `expected/text_unicode.{tokens,grapheme_stats,stream_decode}.golden` を追加し、`docs/spec/3-3-core-text-unicode.md` §9・`README.md`・`docs/plans/bootstrap-roadmap/3-3-core-text-unicode-plan.md`・`docs/guides/{core-parse-streaming,ai-integration}.md` を同期。`reports/spec-audit/ch1/core_text_examples-20270330.md` へ実行ログを保存し、`docs/plans/bootstrap-roadmap/0-4-risk-handling.md` に `R-041 Unicode Data Drift` を登録（担当: Codex）
- 2025-12-23 Docs Examples Move: Chapter 1 構文サンプルを `docs/spec/1-1-syntax/examples/` から `examples/docs-examples/spec/1-1-syntax/` へ移設し、`docs/spec/`・`docs/plans/`・`docs/notes/` 内の参照パスを更新（担当: Codex）
- 2025-12-23 Docs Examples Audit Plan: `docs/plans/docs-examples-audit/` を新設し、Reml コード抽出・検証の計画書を追加。`docs/plans/README.md` にリンクを追記（担当: Codex）
- 2025-12-27 Typeck Improvement: `docs/plans/typeck-improvement/` を新設し、`1-0-type-decl-realization-plan.md` と `README.md` を追加。`docs/plans/README.md` に索引を追記（担当: Codex）。
- 2026-01-01 Stdlib Plugin Migration: `docs/spec/3-18-core-system.md` を新設し、Chapter 3/4/5/README と `docs/guides/runtime/portability.md` を Core.System 移行方針に合わせて更新。`docs/spec/4-4-signal-plugin.md` の低レベル化と `examples/docs-examples/spec/4-4-signal-plugin/*.reml` の整合、`docs/plans/docs-examples-audit/1-1-spec-code-block-inventory.md` の移行タグ付けを追加（担当: Codex）
- 2026-01-01 Core.System Phase E: `compiler/rust/runtime/tests/core_system_api.rs` に Core.System の Unsupported/Signal 変換/Env 互換のユニットテストを追加し、`examples/docs-examples/spec/3-10-core-env` と `4-2-process-plugin`/`4-4-signal-plugin` の診断ログを `reports/spec-audit/ch3`・`ch4` に再採取したうえで `docs-examples-audit-20260101.md` を作成（担当: Codex）
- 2026-01-01 Core.System Phase E follow-up: `docs/spec/4-2-process-plugin.md` と `docs/spec/4-4-signal-plugin.md` のコードブロックを更新し、`examples/docs-examples/spec/4-2-process-plugin/sec_2_1.reml`・`sec_3.reml`・`examples/docs-examples/spec/4-4-signal-plugin/sec_4_1.reml`・`sec_4_2.reml` の構文修正と診断ログ再採取を実施（担当: Codex）
- 2026-01-01 docs-examples-audit Core.System follow-up: `examples/docs-examples/spec/3-18-core-system/*.reml` の検証を `reml_frontend` で再実行しようとしたが、リンク時の `ld: Assertion failed: (name.size() <= maxLength)` で失敗。`reports/spec-audit/summary.md` に失敗ログを記録し、空の diagnostics ファイルは削除（担当: Codex）。
- 2026-01-01 docs-examples-audit Core.System follow-up: `RUSTFLAGS="-C link-arg=-fuse-ld=lld"` で再実行し、`reports/spec-audit/ch3/3-18-core-system__sec_3-20260101-diagnostics.json`/`sec_4_1`/`sec_6` を採取。診断は `parser.syntax.expected_tokens` と `type.unresolved_ident` を確認し、詳細は `reports/spec-audit/summary.md` に記録（担当: Codex）。
- 2026-01-01 docs-examples-audit Core.System follow-up: `examples/docs-examples/spec/3-18-core-system/sec_3.reml` の予約語衝突を解消し、`sec_4_1.reml`/`sec_6.reml` に型スタブを追加して未解決識別子を解消。`RUSTFLAGS="-C link-arg=-fuse-ld=lld"` で再検証し、`sec_3`/`sec_4_1`/`sec_6` の diagnostics 0 件を確認（担当: Codex）。
