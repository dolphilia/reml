{
  "diagnostics": [
    {
      "audit": {
        "effect.stage.required": "stable",
        "effect.stage.actual": "stable",
        "effect.capability": "core.runtime",
        "effect.residual.tags": [
          "panic"
        ],
        "stage_trace": [
          {
            "source": "typer",
            "stage": "stable",
            "capability": "core.runtime"
          },
          {
            "source": "runtime",
            "stage": "stable"
          }
        ]
      },
      "extensions": {
        "effects": {
          "stage": {
            "required": "stable",
            "actual": "stable"
          },
          "residual": {
            "missing": [
              "panic"
            ],
            "leaked_from": "fn demo"
          },
          "declared": [
            "io"
          ],
          "stage_trace": [
            {
              "source": "cli_option",
              "note": "not provided"
            },
            {
              "source": "env_var",
              "note": "REMLC_EFFECT_STAGE not set"
            },
            {
              "source": "typer",
              "stage": "stable",
              "capability": "core.runtime"
            },
            {
              "source": "runtime",
              "stage": "stable",
              "capability": "core.runtime"
            },
            {
              "source": "capability_json",
              "stage": "stable",
              "file": "tooling/runtime/capabilities/default.json"
            }
          ]
        },
        "effect.stage.required": "stable",
        "effect.stage.actual": "stable",
        "effect.stage.capability": "core.runtime",
        "effect.stage_trace": [
          {
            "source": "cli_option",
            "note": "not provided"
          },
          {
            "source": "env_var",
            "note": "REMLC_EFFECT_STAGE not set"
          },
          {
            "source": "typer",
            "stage": "stable",
            "capability": "core.runtime"
          },
          {
            "source": "runtime",
            "stage": "stable",
            "capability": "core.runtime"
          },
          {
            "source": "capability_json",
            "stage": "stable",
            "file": "tooling/runtime/capabilities/default.json"
          }
        ]
      },
      "notes": [
        "`panic` のハンドラが宣言されていないためステージ検証に失敗しました"
      ],
      "domain": "型システム",
      "code": "effects.contract.residual_leak",
      "severity": "error",
      "message": "残余効果が閉じていません",
      "location": {
        "file": "<入力>",
        "line": 1,
        "column": 1,
        "endLine": 1,
        "endColumn": 1
      }
    }
  ]
}
