# Phase 0 Gap Analysis

横断テーマごとに、現行仕様で触れられている内容と未整備の領域を整理したメモ。該当箇所の確認には `scenario-priorities.md` と既存仕様章 (`1-*`, `2-*`, `README`, `scenario-requirements.md`) を参照している。

---

## 1. 型安全な設定／構成 DSL
- **既存の記述**
  - 基本的な束縛・レコード構文は `1-1-syntax.md:76` 付近で説明済み。
  - 型推論は `1-2-types-Inference.md` 全般で定義されている（HM, traits, 値制限）。
- **不足している要素**
  - スキーマ宣言や設定ファイル向け構文の公式仕様がない。
  - 条件付き構成、差分検証、テンプレート展開についての型/意味論が未定義。
  - 標準 API には設定検証ユーティリティに相当する章が存在しない（`2-2` / `2-3` にも未掲載）。

## 2. 高精度なエラー診断とリカバリ支援
- **既存の記述**
  - `2-5-error.md` で期待集合・FixIt・Diagnostic 型を定義。
  - `1-3-effects-safety.md:113` 以降で `panic` や効果の制御を説明。
- **不足している要素**
  - 監査ログ連携やエラー分類のガイドラインがない。
  - システム別エラーコード、FixIt テンプレート、変更履歴との統合が未整備。
  - IDE/LSP へ診断を橋渡しする標準仕様が欠落。

## 3. モジュール化された拡張ポイント（DSL プラグイン）
- **既存の記述**
  - `1-1-syntax.md:51` にモジュールと `use` の概要を簡単に記載。
  - `2-1-parser-type.md` で `ParserId` や `rule` による命名が存在。
- **不足している要素**
  - DSL プラグインのパッケージング／公開方法が不透明。
  - Parser capability、依存解決、バージョン互換のルールがない。
  - 標準 API にプラグイン登録／拡張ポイントを扱う章が未設置。

## 4. ツール／エコシステムとのシームレスな連携
- **既存の記述**
  - `0-1-overview.md` や `0-2-project-purpose.md` にツールフレンドリーの目標が言及。
  - `2-6-execution-strategy.md` はランナー API やストリーミング実行を定義。
- **不足している要素**
  - LSP 連携、構造化ログ、CLI 標準の仕様が未整備。
  - IDE/CI/監査ツールとの統合ガイドが存在しない。
  - `README.md` に横断テーマを把握できるリンクが不足。

## 5. 型システム拡張とデータモデリング
- **既存の記述**
  - ADT、traits、数値リテラルなど基礎型は `1-2-types-Inference.md` で網羅。
- **不足している要素**
  - テンソル型、列型、スキーマ型などドメイン型が未定義。
  - 型と効果の結合（例: DB/クラウド操作）に関する仕様がない。
  - 標準 API にスキーマ検証やデータモデルを扱うユーティリティがない。

## 6. 実行基盤との橋渡し（FFI／ランタイム連携）
- **既存の記述**
  - `1-3-effects-safety.md` が `ffi` / `unsafe` ブロックと所有権方針を説明。
  - `2-6-execution-strategy.md` は run/run_stream/resume などの API を持つ。
- **不足している要素**
  - クラウド/GPU/組み込みなど領域別 FFI ガイドラインがない。
  - 差分適用、ホットリロード、デプロイ戦略の標準 API が未定義。
  - CLI/ツールとしての連携手順がドキュメント化されていない。

---

## 付記
- `scenario-requirements.md` に進捗トラッキング用の欄を追加するタスクは未実施 → フェーズ1の冒頭で対応予定（✅ 要追加）。
- 既存仕様の細部変更はこれ以降のフェーズで順番に反映する。
