# 1.0 Core.Test 計画

## 背景
- DSL の解析結果は構造が複雑であり、差分の手動確認では回帰検知が困難。
- Phase 4 回帰で必要となる診断/期待出力の維持に、標準テスト基盤が欠落している。

## 目的
- DSL 開発者が **統合テスト/ゴールデンテスト/ファジング** を標準 API で実行できるようにする。
- 診断出力と監査ログの一貫性を `Core.Test` から検証可能にする。

## 仕様スコープ
- `test` ブロック・アサーション API・スナップショット更新ポリシーを定義。
- テーブル駆動テスト（入力→期待出力）を簡潔に記述可能にする。
- ファジング入力の責務分界（生成/縮小/再現）を明記する。

## 仕様更新
- 新設: `docs/spec/3-11-core-test.md`
- 更新: `docs/spec/3-0-core-library-overview.md`（モジュール一覧の追加）
- 連携: `docs/spec/3-6-core-diagnostics-audit.md`（診断/監査の検証経路）

## ガイド/サンプル
- 新設: `docs/guides/tooling/testing.md`
- サンプル方針: `examples/` に DSL 解析結果のスナップショット例を配置し、Phase 4 回帰へ登録する。

## リスクと対策
- **スナップショット肥大化**: 更新基準（破壊的変更のみ更新）とレビュー手順を明記する。
- **非決定性**: 診断順序/ハッシュ等の安定化ルールを `Core.Test` で定義する。

## 成果物
- `Core.Test` API の仕様ドラフト
- スナップショット/テーブル駆動テストの書式案
- Phase 4 回帰へのシナリオ登録方針
